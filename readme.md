<h1 align="center">
  Автоматизированный Сканер Портов АСП-24
  <br>
</h1>

## Введение

## Техническая реализация 

### Используемые библиотеки Python

- psycopg

- psutil

- requests

### Внешние зависимости

- Masscan

- Nmap

## Функциональные возможности
- Сканирование одиночных IP-адресов, набора IP-адресов, адресов, записанных CIDR-нотацией

- Получение полной информации об удаленном ресурсе (PTR-запись)

- Нахождение открытых портов и используемых протоколах

- Выявление развернутого ПО и его версии

- Нахождение потенциальных уязвимостей релевантных для выявленного ПО, а также уровня их «критичности»

- Сканирование инфраструктуры для сбора полной информации о сети, а также для выявления наличия открытых портов

- Сбор инвентаризации инфраструктуры – необходимо для понимания активов, используемых в организации

- Интеграция процессов Vulnerability Management – выявление потенциальных уязвимостей, их приоритезация и разработка методов анализа результатов для пользователя

## Использование и запуск

Программа требует права адмиистратора (root) для работы.

Автоматическая установка зависимостей и файлов программы:

```bash
git clone 
cd asp-24
chmod +x ./deploy.sh
./deploy.sh
```


Запуск локального docker контейнера:
```
docker run --name docker -p 5432:5432 -e POSTGRES_PASSWORD=sovietchungus -d postgres
docker exec -it docker psql -U postgres
CREATE DATABASE hack_db;
\q
```

Пароль и название БД не менять!


Принимаемые аргументы:

```
  -h,          --help            Вывести справку
  -q,          --quick           Сканировать только 1000 самых популярных портов
  -d,          --deep            Сканировать все 65536 портов TCP и UDP с использованием masscan и nmap
  -s,          --stealth         Скрытное сканирование
  -a,          --aggressive      Агрессивное сканирование
  -t [Потоки], --threads         Задать количество потоков Nmap
```

Пример команды:

```
sudo /opt/asp-24/asp-24s.py -q -a 10.0.2.0/24
```
Данная команда проведёт быстрое и агрессивное сканирование подсети с CIDR-нотацией 24 (маска 255.255.255.0)

При работе с различными устройствами Masscan может не находить хосты.  Это вызвано особенностями работы TCP/IP стека программы. В таком случае необходимо перечислить все хосты через запятую:

```
sudo /opt/asp-24/asp-24s.py -q -a 10.0.2.1,10.0.2.5
```

В таком случае сканирование будет осуществлено напрямую с использованием Nmap.


## Конфигурация

Для настройки IP-адреса подключаемой БД или токена бота телеграм необходимо поменять значение в файле /opt/asp-24/asp.json:
```
{
    "database": {
        "ip": "127.0.0.1" <-свой IP cюда
    },
    "telegram": {
        "token": "YOUR TOKEN HERE",
        "chat_id": "YOUR CHAT ID HERE"
    }
}
```